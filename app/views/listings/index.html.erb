<h1>Listings</h1>
<%# link_to 'Login with Facebook', auth_at_provider_path(:provider => :facebook) %>

<%= button_tag 'Listings Near Me', id: 'search-nearby' %>

<%= search_form_for @q, url: search_listings_path,
                        html: { method: :post } do |f| %><br>
  <%= f.label :name_cont, "Search Listings" %><br>
  <%= f.text_field :name_cont, placeholder: 'Ask me Anything'%><br>
<!--put in search submit here for simple search -->

<!-- nest advanced search -->

  <h4>Advanced Search</h4>

  <%= f.label :price_gteq, "Minimum Price" %><br>
  <%= f.number_field :price_gteq , placeholder: '0'%><br>

  <%= f.label :price_lteq, "Maximum Price" %><br>
  <%= f.number_field :price_lteq, placeholder: '0' %><br>
<br>
  <%= f.label :location_cont, "Address, Neighbourhood or City" %><br>
  <%= f.text_field :location_cont, placeholder: '123 Something Ave, Toronto' %><br>
<br>
  <%= f.label :bedrooms_gteq, "Minimum Number of bedrooms" %><br>
  <%= f.number_field :bedrooms_gteq, placeholder: '1' %><br><br>

  <%= f.submit %>
<% end %>

<small><%= page_entries_info @listings %></small>

 <table class="listings_list">
   <th>Sort by:</th>
   <th><%= sort_link @q, :name, 'Name' %></th>
   <th><%= sort_link @q, :price, 'Price' %></th>
 </table>
<div id="map-index" ></div>

<div class="listing">
  <%= render @listings %>
</div>

<!-- grabbing elements for map -->
<%= javascript_tag do %>
  window.nearby = <%= raw @listings.map {|n| {lat: n.latitude, lng: n.longitude, name: n.name, desc: n.description, price: n.price, bedrooms: n.bedrooms, date: n.rent_date, id: n.id }}.to_json %>;
<% end %>

<%= paginate @listings %>
